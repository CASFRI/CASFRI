rule_id,target_attribute,target_attribute_type,validation_rules,translation_rules,description,desc_uptodate_with_rules
1,CAS_ID,text,notEmpty(inventory_id);notNull(polyid);notNull(src_filename);notNull(ogc_fid),"padConcat({inventory_id, src_filename, '', polyid, ogc_fid}, {4,15,10,10,7}, {'x','x','x','0','0'}, '-', 'TRUE', 'TRUE')",Concatenates five attributes to create CAS_ID,TRUE
2,INVENTORY_ID,text,notEmpty(inventory_id),copyText(inventory_id),Copies source value,TRUE
3,ORIG_STAND_ID,text,notNull(polyid),copyText(polyid),Copies source value to ORIG_STAND_ID,TRUE
4,STAND_STRUCTURE,text,"matchList(polytype, {'FOR'}|NOT_APPLICABLE);hasCountOfNotNull({ospcomp}, {uspcomp}, 1, FALSE|NOT_APPLICABLE)","avi01_stand_structure_translation(vert, ospcomp, uspcomp)","Validations catches cases that are not forest types and returns NOT_APPLICABLE. No horizontal structure so all NFL polygons should be NOT_APPLICABLE. Translation re-uses the custom function from the AVI in AB. First checks for any Complex rows labelled as CX in the vert column, translates them as C if present. Then returns S if one forest layer and M if two forest layers. Null arguments in the translation function are additional species slots used in AB but not required in ON.",TRUE
5,NUM_OF_LAYERS,integer,true(),"countOfNotNull({ospcomp}, {uspcomp}, {polytype}, 2, 'FALSE')","Counts number of layers based on the presence of a not null value for attributes representing each layer. Assumes valid LYR1 row must have ospcomp, LYR2 must have uspcomp, NFL1 must have polytype. NFL only occurs if there is no forest LYR info. Note that polytype has value FOR when there is forest info, so max_layer number should be set to 2. When ospcomp and uspcomp are empty, polytype is always an NFL value so layer count will always be 1.",TRUE
6,MAP_SHEET_ID,text,false(),nothingText(),Attribute does not occur,TRUE
7,CASFRI_AREA,double precision,"geoIsValid(wkb_geometry, TRUE)",geoArea(wkb_geometry),Validates geometry then calculates area,TRUE
8,CASFRI_PERIMETER,double precision,"geoIsValid(wkb_geometry, TRUE)",geoPerimeter(wkb_geometry),Validates geometry then calculates perimeter,TRUE
9,SRC_INV_AREA,double precision,"notNull(area);isNumeric(area);isGreaterThan(area, 0)",copyDouble(area),Copies source value to SRC_INV_AREA,TRUE
10,STAND_PHOTO_YEAR,integer,"notNull(yrsource);isInt(yrsource);isBetween(yrsource, 1900, 2020)",copyInt(yrsource),Copies source value to STAND_PHOTO_YEAR,TRUE
