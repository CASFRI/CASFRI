rule_id,target_attribute,target_attribute_type,validation_rules,translation_rules,description,desc_uptodate_with_rules
1,CAS_ID,text,notEmpty(inventory_id);notEmpty(src_filename);notNull(orig_stand_id_1);notNull(orig_stand_id_2);notNull(ogc_fid),"padConcat({inventory_id, src_filename, orig_stand_id_1, orig_stand_id_2, ogc_fid}, {4,15,10,10,7}, {'x','x','x','x','x'}, '-', TRUE, TRUE)","Concatenates five attributes to create CAS_ID. Note that polyid in ON02 can have up to 19 characters. To trace back to the source polyon, we split this into two strings during loading, polyid_1_10, and polyid_11_20. Concatenating these and dropping any x characters will return the original polyid identifier.",TRUE
2,INVENTORY_ID,text,notEmpty(inventory_id),copyText(inventory_id),Copies source value,TRUE
3,ORIG_STAND_ID,text,notNull(orig_stand_id),copyText(orig_stand_id),Copies source value,TRUE
4,STAND_STRUCTURE,text,"matchList(polytype, {'FOR'}|NOT_APPLICABLE);hasCountOfNotNull({species_layer1}, {species_layer2}, 1, FALSE|NOT_APPLICABLE)","fim02_stand_structure_translation(stand_structure, species_layer1, species_layer2)","Validations catches cases that are not forest types and returns NOT_APPLICABLE. No horizontal structure so all NFL polygons should be NOT_APPLICABLE. First checks for any Complex rows labelled as CX in the vert column, translates them as COMPLEX if present. Then returns SINGLE_LAYERED if one forest layer and MULTI_LAYERED if two forest layers.",TRUE
5,NUM_OF_LAYERS,integer,"on_fim02_hasCountOfNotNull({species_layer1}, {species_layer2}, polytype, 1, FALSE|-8886)","on_fim02_countOfNotNull({species_layer1}, {species_layer2}, polytype, 3)","Counts number of layers based on the presence of a not null value for attributes representing each layer. Assumes valid LYR1 row must have ospcomp, LYR2 must have uspcomp, NFL1 must have a valid nfl polytype value. NFL only occurs if there is no forest LYR info. Note that polytype has value FOR when there is forest info, so number of layers should never exceed 2. Validation returns UNKNOWN_VALUE if num_of_layers is zero. Any non-productive LYR values are considered valid LYR1 values.",TRUE
6,MAP_SHEET_ID,text,false(),nothingText(),Attribute does not occur,TRUE
7,CASFRI_AREA,double precision,"geoIsValid(wkb_geometry, TRUE|-8888)",geoArea(wkb_geometry),Validates geometry then calculates area,TRUE
8,CASFRI_PERIMETER,double precision,"geoIsValid(wkb_geometry, TRUE|-8888)",geoPerimeter(wkb_geometry),Validates geometry then calculates perimeter,TRUE
9,SRC_INV_AREA,double precision,"notNull(src_inv_area);isNumeric(src_inv_area);isGreaterThan(src_inv_area, 0, FALSE|-8888)","divideDouble(src_inv_area, 10000)",Converts source area from m2 to ha. Return OUT_OF_RANGE for any zero values.,TRUE
10,STAND_PHOTO_YEAR,integer,"notNull(stand_photo_year);isInt(stand_photo_year);isGreaterThan(stand_photo_year, 0, FALSE|-8888);isBetween(stand_photo_year, 1900, 2020)",copyInt(stand_photo_year),Copies source value to STAND_PHOTO_YEAR,TRUE
