rule_id,target_attribute,target_attribute_type,validation_rules,translation_rules,description,desc_uptodate_with_rules
1,CAS_ID,text,notEmpty(inventory_id);notNull(mapsheet);notNull(forest_id);notNull(src_filename);notNull(ogc_fid),"padConcat({inventory_id, src_filename, mapsheet, forest_id, ogc_fid}, {4,15,10,10,7}, {'x','x','x','0','0'}, '-', 'TRUE', 'TRUE')",Concatenates five attributes to create CAS_ID,TRUE
2,INVENTORY_ID,text,notEmpty(inventory_id),copyText(inventory_id),Copies source value,TRUE
3,ORIG_STAND_ID,text,"notNull(forest_id);isInt(forest_id);isGreaterThan(forest_id, 0)",copyText(forest_id),Copies source value to ORIG_STAND_ID,TRUE
4,STAND_STRUCTURE,text,"hasCountOfNotNull({dummy_l1s1, dummy_l1s2, dummy_l1s3, dummy_l1s4, dummy_l1s5}, {dummy_l2s1, dummy_l2s2, dummy_l2s3, dummy_l2s4, dummy_l2s5}, 1, 'FALSE'|NOT_APPLICABLE)","ifElseCountOfNotNullText({dummy_l1s1, dummy_l1s2, dummy_l1s3, dummy_l1s4, dummy_l1s5}, {dummy_l2s1, dummy_l2s2, dummy_l2s3, dummy_l2s4, dummy_l2s5}, 2, 1, 'S', 'M')","Validation catches rows with no forest info and returns NOT_APPLICABLE. Translation runs countOfNotNull for the two forest layers. If one layer, returns S, if two layers returns M. Note that source attributes l1vs and l2vs report the number of canopy layers within the Dominant or Secondary layer. Since the species information is not split between these multiple canopy layers we assume Dominant and Secondary are single layers for the purpose of CASFRI. Dummy names used where values need to be mapped to two different attributes.",TRUE
5,NUM_OF_LAYERS,integer,true(),"countOfNotNull({dummy_l1s1, dummy_l1s2, dummy_l1s3, dummy_l1s4, dummy_l1s5}, {dummy_l2s1, dummy_l2s2, dummy_l2s3, dummy_l2s4, dummy_l2s5}, {slu, water_code, wc}, 3, 'FALSE')","Counts number of layers based on the presence of a not null value for attributes representing each layer. Assumes valid LYR1 row must have l1s1 or l1s2 or l1s3 or l1s4 or l1s5, LYR2 must have l2s1 or l2s2 or l2s3 or l2s4 or l2s5, NFL1/ECO must have slu, water_code or wc. Only 1 NFL/ECO layer possible per polygon. l1s1 can be null when l2s1 has a value. Dummy names used where values need to be mapped to two different attributes.",TRUE
6,MAP_SHEET_ID,text,notNull(mapsheet),copyText(mapsheet),Attribute does not occur,TRUE
7,CASFRI_AREA,double precision,"geoIsValid(wkb_geometry, TRUE)",geoArea(wkb_geometry),Validates geometry then calculates area,TRUE
8,CASFRI_PERIMETER,double precision,"geoIsValid(wkb_geometry, TRUE)",geoPerimeter(wkb_geometry),Validates geometry then calculates perimeter,TRUE
9,SRC_INV_AREA,double precision,"notNull(area);isNumeric(area);isGreaterThan(area, 0)",copyDouble(area),Copies source value to SRC_INV_AREA,TRUE
10,STAND_PHOTO_YEAR,integer,"notNull(stand_photo_year);isInt(stand_photo_year);isBetween(stand_photo_year, 1900, 2020)",copyInt(stand_photo_year),Copies source value to STAND_PHOTO_YEAR,TRUE
