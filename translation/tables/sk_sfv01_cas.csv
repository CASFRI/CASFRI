rule_id,target_attribute,target_attribute_type,validation_rules,translation_rules,description,desc_uptodate_with_rules
1,CAS_ID,text,notEmpty(inventory_id);notEmpty(src_filename);notNull(orig_stand_id);notNull(ogc_fid),"padConcat({inventory_id, src_filename, '', orig_stand_id, ogc_fid}, {4,15,10,10,7}, {'x','x','x','x','x'}, '-', TRUE, TRUE)",Concatenates five attributes to create CAS_ID,TRUE
2,INVENTORY_ID,text,notEmpty(inventory_id),copyText(inventory_id),Copies source value,TRUE
3,ORIG_STAND_ID,text,notNull(orig_stand_id),copyText(orig_stand_id),Copies source value,TRUE
4,STAND_STRUCTURE,text,"hasCountOfNotNull({stand_structure}, {species_1_layer1}, {species_1_layer_2}, {species_1_layer3}, 1, FALSE|NOT_APPLICABLE)","sfv01_stand_structure_translation(stand_structure, species_1_layer1, species_1_layer_2, species_1_layer3)","Validation checks there is a stand structure value (C, S, M) or a species value. Then returns COMPLEX if layer_type is C, otherwise returns SINGLE_LAYERED if only one forest layer and MULTI_LAYERED if multiple forest layers. L1_layer_type always stores the polygon level stand structure value. L2_layer_type and l3_layer_type are always null or the same as l1_layer_type.",TRUE
5,NUM_OF_LAYERS,integer,"sfv01_hasCountOfNotNull({species_1_layer1}, {species_1_layer2}, {species_1_layer3}, {shrub1_layer1}, {herb1_layer1}, productivity_layer, nvsl_layer, aquatic_class_layer, luc_layer, transp_class_layer, 1, FALSE|-8886)","sfv01_countOfNotNull({species_1_layer1}, {species_1_layer2}, {species_1_layer3}, {shrub1_layer1}, {herb1_layer1}, productivity_layer, nvsl_layer, aquatic_class_layer, luc_layer, transp_class_layer, 6)","Count layers up to max of 6. Layers are the forest species for layers 1, 2 and 3, the shrub layer, the herb layer, and a stand-level nfl layer that can be one of nvsl, aquatic_class, luc or transp_class. Custom function checks if nfl row is present then runs countOfNotNull; also assigns non-productive BSH and TMS values to layer1 if present. Only the first species is included for each forest layer as there are no cases where species 2, 3, 4, 5, or 6 are included without species 1. nvsl is the predominant non-veg cover type and can occur when there is forest info. 6 layers is therefore possible. Validation returns UNKNOWN if num_of_layers is zero.",TRUE
6,MAP_SHEET_ID,text,notNull(map_sheet_id);notEmpty(map_sheet_id),copyText(map_sheet_id),Copies source value,TRUE
7,CASFRI_AREA,double precision,"geoIsValid(wkb_geometry, TRUE|NULL_VALUE)",geoArea(wkb_geometry),Validates geometry then calculates area,TRUE
8,CASFRI_PERIMETER,double precision,"geoIsValid(wkb_geometry, TRUE|NULL_VALUE)",geoPerimeter(wkb_geometry),Validates geometry then calculates perimeter,TRUE
9,SRC_INV_AREA,double precision,"notNull(src_inv_area);isNumeric(src_inv_area);isGreaterThan(src_inv_area, 0, FALSE)",copyDouble(src_inv_area),Copies source attribute to SRC_INV_AREA. Return OUT_OF_RANGE for any zero values.,TRUE
10,STAND_PHOTO_YEAR,integer,"notNull(stand_photo_year);isIntSubstring(stand_photo_year, 1, 4, TRUE);isBetweenSubstring(stand_photo_year, 1, 4, 1900, 2020, TRUE, TRUE, TRUE)","substringInt(stand_photo_year, 1, 4, TRUE)",Copies first 4 characters of source value to STAND_PHOTO_YEAR. removeSpaces is set to true in all substring functions.,TRUE
