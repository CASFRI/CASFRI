rule_id,target_attribute,target_attribute_type,validation_rules,translation_rules,description,desc_uptodate_with_rules
1,CAS_ID,text,notEmpty(inventory_id);notNull(orig_stand_id);notNull(src_filename);notNull(ogc_fid),"padConcat({inventory_id, src_filename, '', orig_stand_id, ogc_fid}, {4,15,10,10,7}, {'x','x','x','0','0'}, '-', 'TRUE', 'TRUE')",Concatenates five attributes to create CAS_ID,TRUE
2,INVENTORY_ID,text,notEmpty(inventory_id),copyText(inventory_id),Copies source value,TRUE
3,ORIG_STAND_ID,text,notNull(orig_stand_id),copyText(orig_stand_id),Copies source value to ORIG_STAND_ID,TRUE
4,STAND_STRUCTURE,text,"hasCountOfNotNull({stand_structure}, {species_1_layer1}, {species_1_layer_2}, {species_1_layer3}, 1, 'FALSE'|NOT_APPLICABLE)","sfv01_stand_structure_translation(stand_structure, species_1_layer1, species_1_layer_2, species_1_layer3)","Validation checks values are not null. Then returns C if layer_type is C, otherwise returns S if only one forest layer and M if multiple forest layers. L1_layer_type always stores the polygon level stand structure value. L2_layer_type and l3_layer_type are always null or the same as l1_layer_type.",TRUE
5,NUM_OF_LAYERS,integer,true(),"sfv01_countOfNotNull({species_1_layer1}, {species_1_layer2}, {species_1_layer3}, {shrub1_layer1}, {herb1_layer1}, nvsl_layer, aquatic_class_layer, luc_layer, transp_class_layer, 6, 'FALSE')","Count layers up to max of 6. Layers are the forest species for layers 1, 2 and 3, the shrub layer, the herb layer, and a stand-level nfl layer that can be one of nvsl, aquatic_class, luc or transp_class. Custom function checks if nfl row is present then runs countOfNotNull. Only the first species is included for each forest layer as there are no cases where species 2, 3, 4, 5, or 6 are included without species 1. nvsl is the predominant non-veg cover type and can occur when there is forest info. 6 layers is therefore possible.",TRUE
6,MAP_SHEET_ID,text,notNull(map_sheet_id),copyText(map_sheet_id),Copies source attribute for MAP_SHEET_ID,TRUE
7,CASFRI_AREA,double precision,"geoIsValid(wkb_geometry, TRUE)",geoArea(wkb_geometry),Validates geometry then calculates area,TRUE
8,CASFRI_PERIMETER,double precision,"geoIsValid(wkb_geometry, TRUE)",geoPerimeter(wkb_geometry),Validates geometry then calculates perimeter,TRUE
9,SRC_INV_AREA,double precision,"notNull(src_inv_area);isNumeric(src_inv_area);isGreaterThan(src_inv_area,0)",copyDouble(src_inv_area),Copies source attribute to SRC_INV_AREA,TRUE
10,STAND_PHOTO_YEAR,integer,"notNull(stand_photo_year);isIntSubstring(stand_photo_year, 1, 4, 'TRUE');isBetweenSubstring(stand_photo_year, 1, 4, 1900, 2020, 'TRUE', 'TRUE', 'TRUE')","substringInt(stand_photo_year, 1, 4)",Copies first 4 characters of source value to STAND_PHOTO_YEAR. removeSpaces is set to true in all substring functions.,TRUE
